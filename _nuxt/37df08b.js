(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1194:function(t,e,r){t.exports=r.p+"img/img23.ab1fbd2.png"},1204:function(t,e,r){var content=r(1232);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(110).default)("92fa6254",content,!0,{sourceMap:!1})},1231:function(t,e,r){"use strict";var c=r(1204);r.n(c).a},1232:function(t,e,r){(e=r(109)(!1)).push([t.i,".eshop-breadcrumb{margin:45.33333px 0 20px;border-bottom:1px solid #ddd}.eshop-flexCenter{display:flex;justify-content:center;align-items:center}.eshop-danger{color:red}.eshop-cart-trow:hover{background-color:#e6d6c6}.eshop-cart-tfooter>.eshop-cart-trow:hover,.eshop-cart-thead>.eshop-cart-trow:hover{background-color:#fff}.eshop-cart{background-color:#f2f2f2;margin-top:68px;min-height:calc(100vh - 68px)}.eshop-cart-content{overflow:hidden;max-width:1440px;margin:0 auto;padding:0 10px}.eshop-cart-title{margin:20px 0}.eshop-cart-trow{background-color:#fff;margin:20px 0}.eshop-cart-tcol{padding:0 10px;height:100%}.eshop-cart-tcol>img{height:80px;width:80px}.eshop-cart-tbody,.eshop-cart-tfooter,.eshop-cart-thead{overflow:hidden}.eshop-cart-thead>.eshop-cart-trow{height:56px;line-height:56px}.eshop-cart-tbody>.eshop-cart-trow,.eshop-cart-tfooter>.eshop-cart-trow{height:100px;line-height:100px}.eshop-cart-textRight{text-align:right;line-height:normal}.eshop-cart-number{color:red;font-size:1.3em}",""]),t.exports=e},1276:function(t,e,r){"use strict";r.r(e);r(112),r(1229),r(111),r(639),r(1198),r(37),r(81),r(82),r(51);var c,n,o=r(19),h=r(1194),l=r.n(h),d=r(3),f=r.n(d),v=r(1230),m=r.n(v),x={name:"Hello",data:function(){return{indicator:(0,this.$createElement)("a-icon",{attrs:{type:"loading",spin:!0},style:"font-size: 24px"}),checkedList:[],indeterminate:!1,checkAll:!1,normal:l.a,operating:!1,selectAddress:null,addressVisible:!1}},computed:{addressOptions:function(){return this.$store.state.address.address.map((function(t){return{value:t.id,label:t.address}}))},address:function(){return this.$store.state.address.address},carts:function(){return this.$store.state.cart.cartItems},userId:function(){var t;return null===(t=this.$store.state.user.userInfo)||void 0===t?void 0:t.id},userInfo:function(){return this.$store.state.user.userInfo},checkedListItems:function(){var t=new Map(this.checkedList.map((function(t){return[t,!0]})));return this.carts.filter((function(e){return t.get(e.id)}))},totalNumber:function(){var t;return null===(t=this.checkedListItems)||void 0===t?void 0:t.reduce((function(t,e){return t+e.number}),0)},totalPrice:function(){var t;return null===(t=this.checkedListItems)||void 0===t?void 0:t.reduce((function(t,e){return t+e.number*e.product.price}),0)}},created:function(){this.$store.dispatch("cart/fetchCartData",{userId:this.userId})},mounted:function(){},methods:{getAvatar:function(t){return console.log("HOR",t),t&&t.slideshow?t.slideshow.avatar:this.normal},submitOrder:(n=Object(o.a)(regeneratorRuntime.mark((function t(){var e,r,c,n,o,h=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,0!==this.checkedListItems.length){t.next=4;break}return this.$message.error("请至少选择一项"),t.abrupt("return");case 4:if(this.selectAddress){t.next=7;break}return this.$message.error("请选择地址"),t.abrupt("return");case 7:return c=this.address.find((function(t){return t.id=h.selectAddress})),console.log(this.selectAddress),this.operating=!0,n={time:f()().format("YYYY-MM-DD HH:mm:ss"),userid:this.userId,name:null===(e=this.userInfo)||void 0===e?void 0:e.accountname,phone:null===(r=this.userInfo)||void 0===r?void 0:r.phone,addressAddress:c,orderdetailList:this.checkedListItems.map((function(t){return{productid:t.productid,number:t.number}}))},t.next=13,this.$axios.post("/ordering/submit",n);case 13:if(!(o=t.sent)||!o.data.data){t.next=20;break}this.$message.success("提交成功"),this.deleteItems(this.checkedListItems),this.$router.push({path:"/orderInfo",query:{orderId:o.data.data}}),t.next=21;break;case 20:throw 1;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(0),console.log(t.t0),this.$message.error("提交订单失败");case 27:return t.prev=27,this.operating=!1,t.finish(27);case 30:case"end":return t.stop()}}),t,this,[[0,23,27,30]])}))),function(){return n.apply(this,arguments)}),deleteItems:(c=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),t.prev=1,this.operating=!0,t.next=5,this.$axios.post("/shopping/delete ",e);case 5:t.sent,this.$store.dispatch("cart/fetchCartData",{userId:this.userId}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),this.$message.error("删除失败！");case 13:return t.prev=13,this.operating=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,9,13,16]])}))),function(t){return c.apply(this,arguments)}),cartItemChange:m.a.debounce(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e,r){var c,n,o,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("CART_CHANGE"),t.prev=1,!(e<0||e>r.product.stock)){t.next=4;break}return t.abrupt("return");case 4:if(0!=(c=e-r.number)){t.next=7;break}return t.abrupt("return");case 7:if(this.operating=!0,n=null,!(c>0)){t.next=20;break}return o={productid:r.productid,number:c,userid:this.userId},t.next=13,this.$axios.post("/shopping/addshopping",o);case 13:if(!(n=t.sent)||!n.data.data){t.next=17;break}t.next=18;break;case 17:throw 1;case 18:t.next=28;break;case 20:return h={productid:r.productid,number:-c,userid:this.userId},t.next=23,this.$axios.post("/shopping/deleteshopping",h);case 23:if(!(n=t.sent)||!n.data.data){t.next=27;break}t.next=28;break;case 27:throw 1;case 28:t.next=35;break;case 30:t.prev=30,t.t0=t.catch(1),console.log(t.t0),this.$message.error("处理失败！"),this.$router.go(0);case 35:return t.prev=35,this.operating=!1,this.$store.dispatch("cart/fetchCartData",{userId:this.userId}),t.finish(35);case 39:case"end":return t.stop()}}),t,this,[[1,30,35,39]])})));return function(e,r){return t.apply(this,arguments)}}(),1e3),onChange:function(t){this.indeterminate=!!t.length&&t.length<this.carts.length,this.checkAll=t.length===this.carts.length,console.log(t)},onCheckAllChange:function(t){Object.assign(this,{checkedList:t.target.checked?this.carts.map((function(t){return t.id})):[],indeterminate:!1,checkAll:t.target.checked})}},components:{}},k=(r(1231),r(59)),component=Object(k.a)(x,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"eshop-cart"},[r("div",{staticClass:"eshop-cart-content"},[r("h1",{staticClass:"eshop-cart-title"},[t._v("购物车")]),t._v(" "),r("a-spin",{attrs:{indicator:t.indicator,spinning:t.operating}},[r("div",[r("div",{staticClass:"eshop-cart-thead"},[r("a-row",{staticClass:"eshop-cart-trow"},[r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a-checkbox",{attrs:{checked:t.checkAll,indeterminate:t.indeterminate},on:{change:t.onCheckAllChange}},[t._v("全选")])],1),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:4}},[t._v("图片")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:8}},[t._v("商品名称")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v("单价")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v("数量")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v("库存")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v("小计")]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v("操作")])],1)],1),t._v(" "),r("a-checkbox-group",{style:{width:"100%"},on:{change:t.onChange},model:{value:t.checkedList,callback:function(e){t.checkedList=e},expression:"checkedList"}},[r("div",{staticClass:"eshop-cart-tbody"},t._l(t.carts,(function(e){return r("a-row",{key:e.id,staticClass:"eshop-cart-trow"},[r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a-checkbox",{attrs:{value:e.id}})],1),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:4}},[r("img",{attrs:{src:t.getAvatar(e,t.product)}})]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:8}},[t._v(t._s(e.product.name))]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v(t._s(e.product.price))]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a-input-number",{attrs:{defaultValue:e.number,id:"inputNumber",min:1,max:e.product.stock},on:{change:function(r){return t.cartItemChange(r,e)}}})],1),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v(t._s(e.product.stock))]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[t._v(t._s(e.number*e.product.price))]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a",{staticClass:"eshop-danger",on:{click:function(r){return t.deleteItems([e])}}},[t._v("删除")])])],1)})),1)])],1),t._v(" "),r("div",{staticClass:"eshop-cart-tfooter"},[r("a-row",{staticClass:"eshop-cart-trow"},[r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a-checkbox",{attrs:{checked:t.checkAll,indeterminate:t.indeterminate},on:{change:t.onCheckAllChange}},[t._v("全选")])],1),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:2}},[r("a",{staticClass:"eshop-danger",on:{click:function(e){return t.deleteItems(t.checkedListItems)}}},[t._v("删除")])]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:10}},[r("a",[t._v("清除下架商品")])]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:5}},[r("div",{staticClass:"eshop-flexCenter",style:{height:"100%"}},[r("div",[r("div",{staticClass:"eshop-cart-textRight"},[t._v("\n                            已选"),r("span",{staticClass:"eshop-cart-number"},[t._v(t._s(t.totalNumber))]),t._v("件 合计(不含运费) : "),r("span",{staticClass:"eshop-cart-number"},[t._v(t._s(t.totalPrice))]),t._v("元\n                          ")])])])]),t._v(" "),r("a-col",{staticClass:"eshop-cart-tcol",attrs:{span:5}},[r("div",{staticClass:"eshop-flexCenter",style:{height:"100%"}},[r("a-button",{style:{width:"100%",height:"72px",fontSize:"28px"},attrs:{type:"danger"},on:{click:function(e){t.addressVisible=!0}}},[t._v("确认结算")])],1)])],1)],1)])],1),t._v(" "),r("a-modal",{attrs:{title:"请选择地址",visible:t.addressVisible,"confirm-loading":t.operating},on:{ok:t.submitOrder,cancel:function(e){t.addressVisible=!1}}},[r("div",{style:{display:"flex",justifyContent:"center"}},[r("a-select",{style:{width:"220px"},attrs:{options:t.addressOptions},model:{value:t.selectAddress,callback:function(e){t.selectAddress=e},expression:"selectAddress"}})],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);